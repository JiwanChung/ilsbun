{"version":3,"sources":["meteor://ðŸ’»app/packages/lepozepo_cloudinary/server/configuration.coffee","meteor://ðŸ’»app/packages/lepozepo_cloudinary/server/signature.coffee"],"names":[],"mappings":"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","file":"/packages/lepozepo_cloudinary.js","sourcesContent":["Cloudinary = Npm.require \"cloudinary\"\n\nCloudinary.rules = {}\n","Future = Npm.require \"fibers/future\"\n\nMeteor.methods\n\t\"c.sign\": (ops={}) ->\n\t\tcheck ops, Match.Optional(Object)\n\t\t@unblock()\n\n\t\tif Cloudinary.rules.signature\n\t\t\t@options = ops\n\t\t\tauth_function = _.bind Cloudinary.rules.signature,this\n\t\t\tif not auth_function()\n\t\t\t\tthrow new Meteor.Error \"Unauthorized\", \"Signature not allowed\"\n\n\t\t# Need to add some way to do custom auth\n\t\t# signature = Cloudinary.utils.sign_request ops\n\t\tsignature = Cloudinary.uploader.direct_upload \"\",ops # This is better than utils.sign_request, it returns a POST url as well and properly manages optional parameters\n\n\t\treturn signature\n\n\n\t\"c.delete_by_public_id\": (public_id,type) ->\n\t\tcheck public_id, String\n\t\tcheck type, Match.OneOf(String,undefined,null)\n\t\t@unblock()\n\n\t\tif Cloudinary.rules.delete\n\t\t\t@public_id = public_id\n\t\t\tauth_function = _.bind Cloudinary.rules.delete,this\n\t\t\tif not auth_function()\n\t\t\t\tthrow new Meteor.Error \"Unauthorized\", \"Delete not allowed\"\n\n\t\tif type\n\t\t\tops =\n\t\t\t\ttype:type\n\n\t\tfuture = new Future()\n\n\t\tCloudinary.api.delete_resources [public_id], (result) ->\n\t\t\t\tfuture.return result\n\t\t\t,ops\n\n\t\treturn future.wait()\n\n\t\"c.get_private_resource\": (public_id,ops={}) ->\n\t\tcheck public_id, String\n\t\tcheck ops, Match.Optional(Object)\n\t\t@unblock()\n\n\t\t_.extend ops,\n\t\t\tsign_url:true\n\t\t\ttype:\"private\"\n\n\t\tif Cloudinary.rules.private_resource\n\t\t\t@public_id = public_id\n\t\t\tauth_function = _.bind Cloudinary.rules.private_resource,this\n\t\t\tif not auth_function()\n\t\t\t\tthrow new Meteor.Error \"Unauthorized\", \"Access not allowed\"\n\n\n\t\tCloudinary.url public_id,ops\n\n\t\"c.get_download_url\": (public_id,ops={}) ->\n\t\tcheck public_id, String\n\t\tcheck ops, Match.Optional(Object)\n\t\t@unblock()\n\n\t\tif Cloudinary.rules.download_url\n\t\t\t@public_id = public_id\n\t\t\tauth_function = _.bind Cloudinary.rules.download_url,this\n\t\t\tif not auth_function()\n\t\t\t\tthrow new Meteor.Error \"Unauthorized\", \"Access not allowed\"\n\n\t\tformat = ops.format or \"\"\n\n\t\tCloudinary.utils.private_download_url public_id,format,_.omit(ops,\"format\")\n\n\n\n"]}